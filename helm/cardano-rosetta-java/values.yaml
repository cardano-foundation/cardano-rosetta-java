## -----------------------------------------------------------------------
## Global configuration shared across all subcharts
## -----------------------------------------------------------------------
global:
  namespace: cardano
  network: mainnet
  protocolMagic: 764824073
  releaseVersion: "2.0.0"
  cardanoNodeVersion: "10.5.3"
  pgVersionTag: "REL_18_0"
  mithrilVersion: "2543.1-hotfix"
  profile: mid

  db:
    name: "rosetta-java"
    user: "rosetta_db_admin"
    # password is required â€” pass via --set global.db.password=<value> or a sealed secret
    password: ""
    schema: "public"
    port: 5432
    # host: leave empty to use the in-cluster postgresql service automatically
    host: ""

  # Set to false for offline mode (API only, no node sync wait)
  sync: true

  ## -------------------------------------------------------------------
  ## Hardware profiles: entry / mid / advanced
  ## (nested under global so subcharts can access via .Values.global.profiles)
  ## -------------------------------------------------------------------
  profiles:
    entry:
      resources:
        cardanoNode:
          requests:
            cpu: "1"
            memory: "6Gi"
          limits:
            cpu: "4"
            memory: "12Gi"
        postgresql:
          requests:
            cpu: "1"
            memory: "6Gi"
          limits:
            cpu: "4"
            memory: "12Gi"
        indexer:
          requests:
            cpu: "500m"
            memory: "2Gi"
          limits:
            cpu: "2"
            memory: "4Gi"
        api:
          requests:
            cpu: "250m"
            memory: "1Gi"
          limits:
            cpu: "1"
            memory: "2Gi"
      db:
        poolMin: 12
        poolMax: 12
        maxConnections: 120
        sharedBuffers: "1GB"
        effectiveCacheSize: "2GB"
        workMem: "16MB"
        maintenanceWorkMem: "128MB"
        walBuffers: "16MB"
        checkpointCompletionTarget: "0.7"
        randomPageCost: "3.0"
        effectiveIoConcurrency: 1
        parallelTupleCost: "0.1"
        parallelSetupCost: "1000"
        maxParallelWorkersPerGather: 2
        maxParallelWorkers: 4
        seqPageCost: "1.0"
        jit: "off"
        bgwriterLruMaxpages: 50
        bgwriterDelay: "500ms"

    mid:
      resources:
        cardanoNode:
          requests:
            cpu: "2"
            memory: "12Gi"
          limits:
            cpu: "8"
            memory: "24Gi"
        postgresql:
          requests:
            cpu: "2"
            memory: "12Gi"
          limits:
            cpu: "8"
            memory: "24Gi"
        indexer:
          requests:
            cpu: "1"
            memory: "4Gi"
          limits:
            cpu: "4"
            memory: "8Gi"
        api:
          requests:
            cpu: "500m"
            memory: "2Gi"
          limits:
            cpu: "2"
            memory: "4Gi"
      db:
        poolMin: 150
        poolMax: 150
        maxConnections: 300
        sharedBuffers: "4GB"
        effectiveCacheSize: "8GB"
        workMem: "64MB"
        maintenanceWorkMem: "512MB"
        walBuffers: "512MB"
        checkpointCompletionTarget: "0.7"
        randomPageCost: "1.3"
        effectiveIoConcurrency: 2
        parallelTupleCost: "0.05"
        parallelSetupCost: "500"
        maxParallelWorkersPerGather: 4
        maxParallelWorkers: 8
        seqPageCost: "1.0"
        jit: "off"
        bgwriterLruMaxpages: 200
        bgwriterDelay: "200ms"
        autovacuumMaxWorkers: 5

    advanced:
      resources:
        cardanoNode:
          requests:
            cpu: "4"
            memory: "24Gi"
          limits:
            cpu: "16"
            memory: "48Gi"
        postgresql:
          requests:
            cpu: "4"
            memory: "24Gi"
          limits:
            cpu: "16"
            memory: "48Gi"
        indexer:
          requests:
            cpu: "2"
            memory: "8Gi"
          limits:
            cpu: "8"
            memory: "16Gi"
        api:
          requests:
            cpu: "1"
            memory: "4Gi"
          limits:
            cpu: "4"
            memory: "8Gi"
      db:
        poolMin: 100
        poolMax: 550
        maxConnections: 600
        sharedBuffers: "32GB"
        effectiveCacheSize: "32GB"
        workMem: "96MB"
        maintenanceWorkMem: "2GB"
        walBuffers: "512MB"
        checkpointCompletionTarget: "0.9"
        randomPageCost: "1.2"
        effectiveIoConcurrency: 200
        parallelTupleCost: "0.03"
        parallelSetupCost: "300"
        maxParallelWorkersPerGather: 8
        maxParallelWorkers: 16
        seqPageCost: "0.5"
        jit: "off"
        bgwriterLruMaxpages: 300
        bgwriterDelay: "200ms"
        autovacuumMaxWorkers: 5

  ## -------------------------------------------------------------------
  ## Storage configuration
  ## (nested under global so subcharts can access via .Values.global.storage)
  ## -------------------------------------------------------------------
  storage:
    cardanoNode:
      size: 500Gi
      storageClass: ""
    postgresql:
      size: 200Gi
      storageClass: ""
    prometheus:
      size: 50Gi
      storageClass: ""
    grafana:
      size: 10Gi
      storageClass: ""

  ## -------------------------------------------------------------------
  ## Mithril snapshot download
  ## (nested under global so subcharts can access via .Values.global.mithril)
  ## -------------------------------------------------------------------
  mithril:
    enabled: true
    sync: true
    snapshotDigest: "latest"
    aggregatorEndpoint: "https://aggregator.release-mainnet.api.mithril.network/aggregator"
    genesisVerificationKey: ""
    ancillaryVerificationKey: ""

## -----------------------------------------------------------------------
## Index applier job (post-install hook)
## -----------------------------------------------------------------------
indexApplier:
  enabled: true
  pollInterval: 60

## -----------------------------------------------------------------------
## Stress testing with k6
## -----------------------------------------------------------------------
stressTesting:
  enabled: false
  profile: smoke
  targetUrl: "http://rosetta-rosetta-api:8082"

## -----------------------------------------------------------------------
## Subchart toggles
## -----------------------------------------------------------------------
cardano-node:
  enabled: true

postgresql:
  enabled: true

yaci-indexer:
  enabled: true

rosetta-api:
  enabled: true

monitoring:
  enabled: false
