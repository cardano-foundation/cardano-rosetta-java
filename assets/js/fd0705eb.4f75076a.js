"use strict";(self.webpackChunkrosetta_docs=self.webpackChunkrosetta_docs||[]).push([[7282],{548:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>d,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"user-guides/staking","title":"Staking Operations","description":"How to perform staking operations through Cardano Rosetta API","source":"@site/docs/user-guides/staking.md","sourceDirName":"user-guides","slug":"/user-guides/staking","permalink":"/cardano-rosetta-java/docs/user-guides/staking","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-foundation/cardano-rosetta-java/tree/main/docs/docs/user-guides/staking.md","tags":[],"version":"current","lastUpdatedBy":"Lincon Vidal","lastUpdatedAt":1771413374000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Staking Operations","description":"How to perform staking operations through Cardano Rosetta API"},"sidebar":"tutorialSidebar","previous":{"title":"Native Tokens","permalink":"/cardano-rosetta-java/docs/user-guides/multi-assets"},"next":{"title":"DRep Delegation","permalink":"/cardano-rosetta-java/docs/user-guides/drep-delegation"}}');var r=t(4848),s=t(8453),i=t(5537),o=t(9329);const d={sidebar_position:2,title:"Staking Operations",description:"How to perform staking operations through Cardano Rosetta API"},l="Staking Operations",c={},u=[{value:"Overview",id:"overview",level:2},{value:"Staking Operation Types",id:"staking-operation-types",level:2},{value:"Governance Prerequisite for Reward Withdrawals",id:"governance-prerequisite-for-reward-withdrawals",level:2},{value:"Operation Examples",id:"operation-examples",level:2},{value:"Required Metadata",id:"required-metadata",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"staking-operations",children:"Staking Operations"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Cardano's Proof of Stake system allows ADA holders to delegate their stake to stake pools and participate in the network consensus. The Rosetta API implementation supports all staking operations required to participate in this system."}),"\n",(0,r.jsx)(n.h2,{id:"staking-operation-types",children:"Staking Operation Types"}),"\n",(0,r.jsxs)(n.p,{children:["Each staking operation is sent in requests to the ",(0,r.jsx)(n.code,{children:"/construction/preprocess"})," and ",(0,r.jsx)(n.code,{children:"/construction/payloads"})," endpoints with specific operation types:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Operation Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"input"})}),(0,r.jsx)(n.td,{children:"Transaction input"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"output"})}),(0,r.jsx)(n.td,{children:"Transaction output"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"stakeKeyRegistration"})}),(0,r.jsx)(n.td,{children:"Register a stake key"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"stakeKeyDeregistration"})}),(0,r.jsx)(n.td,{children:"Deregister a stake key"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"stakeDelegation"})}),(0,r.jsx)(n.td,{children:"Delegate stake to a pool"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"withdrawal"})}),(0,r.jsx)(n.td,{children:"Withdraw rewards"})]})]})]}),"\n",(0,r.jsxs)(n.admonition,{type:"important",children:[(0,r.jsx)(n.p,{children:"The order of operations is important since they are processed in a specific sequence:"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Inputs and outputs"}),"\n",(0,r.jsx)(n.li,{children:"Operations requiring certificates (registrations, deregistrations, delegations)"}),"\n",(0,r.jsx)(n.li,{children:"Withdrawals"}),"\n"]})]}),"\n",(0,r.jsx)(n.h2,{id:"governance-prerequisite-for-reward-withdrawals",children:"Governance Prerequisite for Reward Withdrawals"}),"\n",(0,r.jsxs)(n.admonition,{type:"important",children:[(0,r.jsx)(n.p,{children:"In the current governance era, withdrawing stake rewards requires the stake credential to be delegated to a DRep."}),(0,r.jsxs)(n.p,{children:["For exchange flows, treat DRep delegation as a pre-check before building ",(0,r.jsx)(n.code,{children:"withdrawal"})," operations."]})]}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.a,{href:"/docs/user-guides/drep-delegation",children:"DRep Delegation guide"})," to build or update ",(0,r.jsx)(n.code,{children:"dRepVoteDelegation"})," operations before withdrawal when needed."]}),"\n",(0,r.jsx)(n.h2,{id:"operation-examples",children:"Operation Examples"}),"\n",(0,r.jsxs)(i.A,{children:[(0,r.jsx)(o.A,{value:"input",label:"Input Operation",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "operation_identifier": {\n    "index": 0,\n    "network_index": 0\n  },\n  "type": "input",\n  "status": "success",\n  "account": {\n    "address": "addr1vxa5pudxg77g3sdaddecmw8tvc6hmynywn49lltt4fmvn7cpnkcpx"\n  },\n  "amount": {\n    "value": "-9000000",\n    "currency": {\n      "symbol": "ADA",\n      "decimals": 6\n    }\n  },\n  "coin_change": {\n    "coin_identifier": {\n      "identifier": "2f23fd8cca835af21f3ac375bac601f97ead75f2e79143bdf71fe2c4be043e8f:1"\n    },\n    "coin_action": "coin_spent"\n  }\n}\n'})})}),(0,r.jsx)(o.A,{value:"output",label:"Output Operation",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "operation_identifier": {\n    "index": 1\n  },\n  "related_operations": [\n    {\n      "index": 0\n    }\n  ],\n  "type": "output",\n  "status": "success",\n  "account": {\n    "address": "addr1vxa5pudxg77g3sdaddecmw8tvc6hmynywn49lltt4fmvn7cpnkcpx"\n  },\n  "amount": {\n    "value": "10000",\n    "currency": {\n      "symbol": "ADA",\n      "decimals": 6\n    }\n  }\n}\n'})})}),(0,r.jsxs)(o.A,{value:"stake-key-registration",label:"Stake Key Registration",children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "operation_identifier": {\n    "index": 3\n  },\n  "type": "stakeKeyRegistration",\n  "status": "success",\n  "metadata": {\n    "staking_credential": {\n      "hex_bytes": "1B400D60AAF34EAF6DCBAB9BBA46001A23497886CF11066F7846933D30E5AD3F",\n      "curve_type": "edwards25519"\n    }\n  }\n}\n'})}),(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"No amount is needed for this operation. The deposit will be calculated using the fixed minimum key deposit value times the number of stake key registrations."})})]}),(0,r.jsx)(o.A,{value:"stake-delegation",label:"Stake Delegation",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "operation_identifier": {\n    "index": 3\n  },\n  "type": "stakeDelegation",\n  "status": "success",\n  "metadata": {\n    "staking_credential": {\n      "hex_bytes": "1B400D60AAF34EAF6DCBAB9BBA46001A23497886CF11066F7846933D30E5AD3F",\n      "curve_type": "edwards25519"\n    },\n    "pool_key_hash": "1b268f4cba3faa7e36d8a0cc4adca2096fb856119412ee7330f692b5"\n  }\n}\n'})})}),(0,r.jsxs)(o.A,{value:"stake-key-deregistration",label:"Stake Key Deregistration",children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "operation_identifier": {\n    "index": 3\n  },\n  "type": "stakeKeyDeregistration",\n  "status": "success",\n  "metadata": {\n    "staking_credential": {\n      "hex_bytes": "1B400D60AAF34EAF6DCBAB9BBA46001A23497886CF11066F7846933D30E5AD3F",\n      "curve_type": "edwards25519"\n    }\n  }\n}\n'})}),(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"No amount is needed for this operation. The refund will be calculated using the fixed minimum key deposit value times the number of stake key deregistrations."})})]}),(0,r.jsx)(o.A,{value:"withdrawal",label:"Withdrawal",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "operation_identifier": {\n    "index": 4\n  },\n  "type": "withdrawal",\n  "status": "success",\n  "amount": {\n    "value": "10000",\n    "currency": {\n      "symbol": "ADA",\n      "decimals": 6\n    }\n  },\n  "metadata": {\n    "staking_credential": {\n      "hex_bytes": "1B400D60AAF34EAF6DCBAB9BBA46001A23497886CF11066F7846933D30E5AD3F",\n      "curve_type": "edwards25519"\n    }\n  }\n}\n'})})})]}),"\n",(0,r.jsx)(n.h2,{id:"required-metadata",children:"Required Metadata"}),"\n",(0,r.jsx)(n.p,{children:"Each staking operation requires specific metadata:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Operation"}),(0,r.jsx)(n.th,{children:"Required Metadata"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Stake Key Registration"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"staking_credential"})," (hex bytes and curve type)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Stake Delegation"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"staking_credential"})," and ",(0,r.jsx)(n.code,{children:"pool_key_hash"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Stake Key Deregistration"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"staking_credential"})," (hex bytes and curve type)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Withdrawal"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"staking_credential"})," and ",(0,r.jsx)(n.code,{children:"amount"})]})]})]})]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},5537:(e,n,t)=>{t.d(n,{A:()=>k});var a=t(6540),r=t(4164),s=t(5627),i=t(6347),o=t(372),d=t(604),l=t(1861),c=t(8749);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:r}}=e;return{value:n,label:t,attributes:a,default:r}}))}(t);return function(e){const n=(0,l.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function x(e){let{queryString:n=!1,groupId:t}=e;const r=(0,i.W6)(),s=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,d.aZ)(s),(0,a.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(r.location.search);n.set(s,e),r.replace({...r.location,search:n.toString()})}),[s,r])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,s=h(e),[i,d]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:s}))),[l,u]=x({queryString:t,groupId:r}),[g,m]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,s]=(0,c.Dv)(t);return[r,(0,a.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:r}),j=(()=>{const e=l??g;return p({value:e,tabValues:s})?e:null})();(0,o.A)((()=>{j&&d(j)}),[j]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);d(e),u(e),m(e)}),[u,m,s]),tabValues:s}}var m=t(9136);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(4848);function b(e){let{className:n,block:t,selectedValue:a,selectValue:i,tabValues:o}=e;const d=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),c=e=>{const n=e.currentTarget,t=d.indexOf(n),r=o[t].value;r!==a&&(l(n),i(r))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=d.indexOf(e.currentTarget)+1;n=d[t]??d[0];break}case"ArrowLeft":{const t=d.indexOf(e.currentTarget)-1;n=d[t]??d[d.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>{d.push(e)},onKeyDown:u,onClick:c,...s,className:(0,r.A)("tabs__item",j.tabItem,s?.className,{"tabs__item--active":a===n}),children:t??n},n)}))})}function v(e){let{lazy:n,children:t,selectedValue:s}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===s));return e?(0,a.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function y(e){const n=g(e);return(0,f.jsxs)("div",{className:(0,r.A)("tabs-container",j.tabList),children:[(0,f.jsx)(b,{...n,...e}),(0,f.jsx)(v,{...n,...e})]})}function k(e){const n=(0,m.A)();return(0,f.jsx)(y,{...e,children:u(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var a=t(6540);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}},9329:(e,n,t)=>{t.d(n,{A:()=>i});t(6540);var a=t(4164);const r={tabItem:"tabItem_Ymn6"};var s=t(4848);function i(e){let{children:n,hidden:t,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(r.tabItem,i),hidden:t,children:n})}}}]);