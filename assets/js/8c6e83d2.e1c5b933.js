"use strict";(self.webpackChunkrosetta_docs=self.webpackChunkrosetta_docs||[]).push([[4934],{5537:(e,n,a)=>{a.d(n,{A:()=>w});var t=a(6540),s=a(4164),r=a(5627),o=a(6347),i=a(372),d=a(604),c=a(1861),l=a(8749);function h(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:n,children:a}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:a,attributes:t,default:s}}=e;return{value:n,label:a,attributes:t,default:s}}))}(a);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,a])}function p(e){let{value:n,tabValues:a}=e;return a.some((e=>e.value===n))}function b(e){let{queryString:n=!1,groupId:a}=e;const s=(0,o.W6)(),r=function(e){let{queryString:n=!1,groupId:a}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:n,groupId:a});return[(0,d.aZ)(r),(0,t.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(s.location.search);n.set(r,e),s.replace({...s.location,search:n.toString()})}),[r,s])]}function x(e){const{defaultValue:n,queryString:a=!1,groupId:s}=e,r=u(e),[o,d]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=a.find((e=>e.default))??a[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r}))),[c,h]=b({queryString:a,groupId:s}),[x,m]=function(e){let{groupId:n}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,r]=(0,l.Dv)(a);return[s,(0,t.useCallback)((e=>{a&&r.set(e)}),[a,r])]}({groupId:s}),j=(()=>{const e=c??x;return p({value:e,tabValues:r})?e:null})();(0,i.A)((()=>{j&&d(j)}),[j]);return{selectedValue:o,selectValue:(0,t.useCallback)((e=>{if(!p({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);d(e),h(e),m(e)}),[h,m,r]),tabValues:r}}var m=a(9136);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=a(4848);function g(e){let{className:n,block:a,selectedValue:t,selectValue:o,tabValues:i}=e;const d=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),l=e=>{const n=e.currentTarget,a=d.indexOf(n),s=i[a].value;s!==t&&(c(n),o(s))},h=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const a=d.indexOf(e.currentTarget)+1;n=d[a]??d[0];break}case"ArrowLeft":{const a=d.indexOf(e.currentTarget)-1;n=d[a]??d[d.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":a},n),children:i.map((e=>{let{value:n,label:a,attributes:r}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>{d.push(e)},onKeyDown:h,onClick:l,...r,className:(0,s.A)("tabs__item",j.tabItem,r?.className,{"tabs__item--active":t===n}),children:a??n},n)}))})}function y(e){let{lazy:n,children:a,selectedValue:r}=e;const o=(Array.isArray(a)?a:[a]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===r));return e?(0,t.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function v(e){const n=x(e);return(0,f.jsxs)("div",{className:(0,s.A)("tabs-container",j.tabList),children:[(0,f.jsx)(g,{...n,...e}),(0,f.jsx)(y,{...n,...e})]})}function w(e){const n=(0,m.A)();return(0,f.jsx)(v,{...e,children:h(e.children)},String(n))}},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>i});var t=a(6540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}},8554:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>d,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"core-concepts/cardano-addons","title":"Cardano API Additions","description":"Documentation for Cardano-specific API extensions","source":"@site/docs/core-concepts/cardano-addons.md","sourceDirName":"core-concepts","slug":"/core-concepts/cardano-addons","permalink":"/cardano-rosetta-java/docs/core-concepts/cardano-addons","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-foundation/cardano-rosetta-java/tree/main/docs/docs/core-concepts/cardano-addons.md","tags":[],"version":"current","lastUpdatedBy":"matiwinnetou","lastUpdatedAt":1757071290000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Cardano API Additions","description":"Documentation for Cardano-specific API extensions"},"sidebar":"tutorialSidebar","previous":{"title":"System Architecture","permalink":"/cardano-rosetta-java/docs/core-concepts/architecture"},"next":{"title":"Transaction Flow","permalink":"/cardano-rosetta-java/docs/core-concepts/transaction-flow"}}');var s=a(4848),r=a(8453),o=a(5537),i=a(9329);const d={sidebar_position:2,title:"Cardano API Additions",description:"Documentation for Cardano-specific API extensions"},c="Cardano API Additions",l={},h=[{value:"Cardano Operation Types",id:"cardano-operation-types",level:2},{value:"Endpoint specific changes",id:"endpoint-specific-changes",level:2},{value:"<code>/search/transactions</code>",id:"searchtransactions",level:3},{value:"<code>/block</code>",id:"block",level:3},{value:"<code>/block/transactions</code>",id:"blocktransactions",level:3},{value:"<code>/account/balance</code>",id:"accountbalance",level:3},{value:"<code>/account/coins</code>",id:"accountcoins",level:3},{value:"<code>/construction/derive</code>",id:"constructionderive",level:3},{value:"Examples",id:"examples",level:4},{value:"<code>/construction/preprocess</code>",id:"constructionpreprocess",level:3},{value:"Example metadata",id:"example-metadata",level:4},{value:"<code>/construction/metadata</code>",id:"constructionmetadata",level:3},{value:"<code>/construction/payloads</code>",id:"constructionpayloads",level:3},{value:"<code>/construction/parse</code>",id:"constructionparse",level:3},{value:"<code>/construction/combine</code>",id:"constructioncombine",level:3},{value:"Other considerations",id:"other-considerations",level:2},{value:"Encoded transactions",id:"encoded-transactions",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"cardano-api-additions",children:"Cardano API Additions"})}),"\n",(0,s.jsxs)(n.p,{children:["Although ",(0,s.jsx)(n.code,{children:"Cardano Rosetta Java"})," is compliant with ",(0,s.jsx)(n.a,{href:"https://docs.cloud.coinbase.com/rosetta/docs/welcome",children:"Rosetta Spec"}),",\nsome changes were added, mostly as metadata, as they contain Cardano specific information that needs to be either processed or returned."]}),"\n",(0,s.jsx)(n.p,{children:"To keep it easy, clear and upgradable for changes in the future, all specific metadata are added at the end of the API documentation."}),"\n",(0,s.jsx)(n.p,{children:"To get a detailed view of the API and the changes, refer to the Rosetta API reference documentation."}),"\n",(0,s.jsx)(n.h2,{id:"cardano-operation-types",children:"Cardano Operation Types"}),"\n",(0,s.jsx)(n.p,{children:"Operations are used to represent components of transactions across the Rosetta API. They are returned from Data API endpoints and used by Construction API endpoints to build transactions."}),"\n",(0,s.jsx)(n.p,{children:"Cardano Rosetta supports all operations available within the Cardano blockchain:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/Operation",target:"_blank",children:(0,s.jsx)(n.code,{children:"Input"})})," - Represents ADA or tokens being spent from a UTXO"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/Operation",target:"_blank",children:(0,s.jsx)(n.code,{children:"Output"})})," - Represents ADA or tokens being sent to an address"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/OperationMetadata",target:"_blank",children:(0,s.jsx)(n.code,{children:"Stake_Key_Registration"})})," - Registers a stake key for staking"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/OperationMetadata",target:"_blank",children:(0,s.jsx)(n.code,{children:"Stake_Key_Deregistration"})})," - Deregisters a stake key"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/OperationMetadata",target:"_blank",children:(0,s.jsx)(n.code,{children:"Stake_Delegation"})})," - Delegates a stake to a pool"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/OperationMetadata",target:"_blank",children:(0,s.jsx)(n.code,{children:"Withdrawal"})})," - Withdraws rewards from a reward account"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/PoolRegistrationParams",target:"_blank",children:(0,s.jsx)(n.code,{children:"Pool_Registration"})})," - Registers a stake pool"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/OperationMetadata",target:"_blank",children:(0,s.jsx)(n.code,{children:"Pool_Retirement"})})," - Retires a stake pool"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)("a",{href:"/cardano-rosetta-java/api#model/DRepParams",target:"_blank",children:(0,s.jsx)(n.code,{children:"dRepVoteDelegation"})})," - Delegates voting power to a Delegated Representative (DRep) for Cardano governance"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"To support these operations, extra metadata is added to the standard Rosetta operation structure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "withdrawalAmount": { "type": "Amount" },\n  "depositAmount": { "type": "Amount" },\n  "refundAmount": { "type": "Amount" },\n  "staking_credential": { "type": "PublicKey" },\n  "pool_key_hash": { "type": "string" },\n  "epoch": { "type": "number" },\n  "tokenBundle": { "type": "TokenBundleItem" },\n  "poolRegistrationCert": { "type": "string" },\n  "poolRegistrationParams": { "type": "PoolRegistrationParams" },\n  "drep": { "type": "DRepObject" }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"endpoint-specific-changes",children:"Endpoint specific changes"}),"\n",(0,s.jsx)(n.h3,{id:"searchtransactions",children:(0,s.jsx)(n.code,{children:"/search/transactions"})}),"\n",(0,s.jsxs)(n.p,{children:["Added ",(0,s.jsx)(n.code,{children:"block_identifier"})," this enables the user to search for transactions within a particular block. Either index or hash must be set.\nIf both are set from a different block, the returned list will be empty."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "block_identifier": {\n    "hash": "XXXXXX",\n    "index": "000"\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This API can be disabled by setting ",(0,s.jsx)(n.code,{children:"DISABLE_SEARCH_API"})," env variable to ",(0,s.jsx)(n.code,{children:"t"}),", ",(0,s.jsx)(n.code,{children:"true"})," or 1."]}),"\n",(0,s.jsxs)(n.p,{children:["Max amount of transactions allowed to be requested is defined by ",(0,s.jsx)(n.code,{children:"PAGE_SIZE"})," env variable, which is the same used at ",(0,s.jsx)(n.code,{children:"/block/transaction"})," endpoint. Also, this value will be used if no limit parameter is received."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"status"})," and ",(0,s.jsx)(n.code,{children:"success"})," filters are equivalent. If they are both set and they don't match, an error will be thrown. In the same way works ",(0,s.jsx)(n.code,{children:"address"})," and ",(0,s.jsx)(n.code,{children:"account_identifier.address"}),".\n",(0,s.jsx)(n.code,{children:"status"})," and ",(0,s.jsx)(n.code,{children:"maxBlock"})," filters work as excluding filters, if they are set, besides operator value."]})}),"\n",(0,s.jsx)(n.admonition,{title:"Pruning limitation",type:"warning",children:(0,s.jsx)(n.p,{children:"Searching for transactions by hash is always possible, because transaction records themselves are never pruned. However, searching by address is limited: address-based searches depend on the UTXO set, and once spent UTXOs older than the pruning window are deleted, only transactions involving current or recently spent UTXOs can be found by address. Older history is not returned once pruned."})}),"\n",(0,s.jsx)(n.h3,{id:"block",children:(0,s.jsx)(n.code,{children:"/block"})}),"\n",(0,s.jsx)(n.p,{children:"The following metadata is also returned, when querying for block information:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "transactionsCount": { "type": "number" },\n  "createdBy": { "type": "string" },\n  "size": { "type": "number" },\n  "epochNo": { "type": "number" },\n  "slotNo": { "type": "integer", "format": "int64" }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["For transaction fields for the ",(0,s.jsx)(n.code,{children:"size"})," and ",(0,s.jsx)(n.code,{children:"scriptSize"})," are added to Transaction metadata."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "size": { "type": "integer", "format": "int64" },\n  "scriptSize": { "type": "integer", "format": "int64" }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"blocktransactions",children:(0,s.jsx)(n.code,{children:"/block/transactions"})}),"\n",(0,s.jsx)(n.p,{children:"When the block requested contains transactions with multi assets operations, the token bundles associated to each operation will be returned as metadata."}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"Token values are negative for input operations (spending) and positive for output operations (receiving)."}),(0,s.jsxs)(n.p,{children:["For comprehensive documentation on native token operations, including sign conventions, minting/burning observations, and construction examples, see the ",(0,s.jsx)(n.a,{href:"/user-guides/multi-assets",children:"Native Tokens User Guide"}),"."]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example for an input operation (spending tokens):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "metadata": {\n    "tokenBundle": [\n      {\n        "policyId": "3e6fc736d30770b830db70994f25111c18987f1407585c0f55ca470f",\n        "tokens": [\n          {\n            "value": "-5",\n            "currency": {\n              "symbol": "jxToken1",\n              "decimals": 0\n            }\n          }\n        ]\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Assets will be returned sorted by name."})}),"\n",(0,s.jsx)(n.h3,{id:"accountbalance",children:(0,s.jsx)(n.code,{children:"/account/balance"})}),"\n",(0,s.jsxs)(n.p,{children:["For accounts that have a multi asset balance, these will be returned with the corresponding policy passed as metadata at ",(0,s.jsx)(n.code,{children:"currency"})," as follows:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "balances": [\n    {\n      "value": "4800000",\n      "currency": {\n        "symbol": "ADA",\n        "decimals": 6\n      }\n    },\n    {\n      "value": "20",\n      "currency": {\n        "symbol": "",\n        "decimals": 0,\n        "metadata": {\n          "policyId": "181aace621eea2b6cb367adb5000d516fa785087bad20308c072517e"\n        }\n      }\n    },\n    {\n      "value": "10",\n      "currency": {\n        "symbol": "jxToken1",\n        "decimals": 0,\n        "metadata": {\n          "policyId": "fc5a8a0aac159f035a147e5e2e3eb04fa3b5e67257c1b971647a717d"\n        }\n      }\n    }\n  ]\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["When querying ",(0,s.jsx)(n.code,{children:"/account/balance"}),", the result depends on the type of address:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["For a ",(0,s.jsx)(n.strong,{children:"payment address"}),' (Base or Enterprise), the response contains the sum of all unspent UTXOs for that address (the "spendable" balance).']}),"\n",(0,s.jsxs)(n.li,{children:["For a ",(0,s.jsx)(n.strong,{children:"stake address"})," (reward address), the response contains only the available rewards that can be withdrawn from that stake address."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"To present a wallet's total value, clients should query both the payment address (for spendable funds) and the stake address (for rewards), then combine the results."}),"\n",(0,s.jsx)(n.admonition,{title:"Note on Stake Addresses",type:"info",children:(0,s.jsxs)(n.p,{children:["A stake address never holds UTXOs and cannot have a spendable balance. The ",(0,s.jsx)(n.code,{children:"/account/balance"})," response for a stake address always reflects only the withdrawable rewards."]})}),"\n",(0,s.jsx)(n.p,{children:"Internally, the Rosetta service gathers these two figures from different subsystems:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Spendable funds"})," (ADA and native tokens) are obtained by summing all unspent UTXOs that belong to the payment address(es). These UTXOs are stored in the PostgreSQL database maintained by the ",(0,s.jsx)(n.strong,{children:"Yaci Indexer"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rewards balance"})," is fetched directly from the ",(0,s.jsx)(n.strong,{children:"Yaci Store"})," through a lightweight internal HTTP call, which queries the current withdrawable rewards for the stake address."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"As a consequence, the spendable portion updates whenever new blocks modify the UTXO set for the payment address, whereas the rewards portion changes only after the protocol distributes staking rewards (typically once per epoch)."}),"\n",(0,s.jsx)(n.h3,{id:"accountcoins",children:(0,s.jsx)(n.code,{children:"/account/coins"})}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"include_mempool"})," is an optional parameter that can be used to include mempool transactions in the response.\nIf not set, it will be ignored. Default is false, since mempool tracking is not activated by default as well.\n",(0,s.jsx)(n.strong,{children:"Note: Mempool functionality is not implemented yet."})]})}),"\n",(0,s.jsx)(n.h3,{id:"constructionderive",children:(0,s.jsx)(n.code,{children:"/construction/derive"})}),"\n",(0,s.jsx)(n.p,{children:"Following the Rosetta specification, this endpoint returns an Enterprise address by default.\nIn addition to that, Cardano Rosetta Java allows the creation of Reward and Base addresses, which aren't supported in the Rosetta specification.\nTherefore, following optional parameters were added as metadata:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"address_type"}),": Either ",(0,s.jsx)(n.code,{children:"Reward"}),", ",(0,s.jsx)(n.code,{children:"Base"})," or ",(0,s.jsx)(n.code,{children:"Enterprise"}),". It will default to ",(0,s.jsx)(n.code,{children:"Enterprise"})," and will throw an error if any other value is provided."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"staking_credential"}),": The public key that will be used for creating a Base address. This field is only mandatory if the provided ",(0,s.jsx)(n.code,{children:"address_type"})," is ",(0,s.jsx)(n.code,{children:"Base"}),". It's ignored in other cases since the Reward and the Enterprise addresses are created with the public key already included in the request."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"examples",children:"Examples"}),"\n","\n",(0,s.jsxs)(o.A,{children:[(0,s.jsx)(i.A,{value:"base",label:"Base address",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "network_identifier": {\n    "blockchain": "cardano",\n    "network": "mainnet"\n  },\n  "public_key": {\n    "hex_bytes": "159abeeecdf167ccc0ea60b30f9522154a0d74161aeb159fb43b6b0695f057b3",\n    "curve_type": "edwards25519"\n  },\n  "metadata": {\n    "address_type": "Base",\n    "staking_credential": {\n      "hex_bytes": "964774728c8306a42252adbfb07ccd6ef42399f427ade25a5933ce190c5a8760",\n      "curve_type": "edwards25519"\n    }\n  }\n}\n'})})}),(0,s.jsx)(i.A,{value:"reward",label:"Reward address",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "network_identifier": {\n    "blockchain": "cardano",\n    "network": "mainnet"\n  },\n  "public_key": {\n    "hex_bytes": "964774728c8306a42252adbfb07ccd6ef42399f427ade25a5933ce190c5a8760",\n    "curve_type": "edwards25519"\n  },\n  "metadata": {\n    "address_type": "Reward"\n  }\n}\n'})})}),(0,s.jsxs)(i.A,{value:"enterprise",label:"Enterprise address",children:[(0,s.jsxs)(n.p,{children:["In this case the metadata is optional. If it's provided, then the ",(0,s.jsx)(n.code,{children:"address_type"})," should be ",(0,s.jsx)(n.code,{children:"Enterprise"})," and any ",(0,s.jsx)(n.code,{children:"staking_credential"})," will be ignored."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "network_identifier": {\n    "blockchain": "cardano",\n    "network": "mainnet"\n  },\n  "public_key": {\n    "hex_bytes": "159abeeecdf167ccc0ea60b30f9522154a0d74161aeb159fb43b6b0695f057b3",\n    "curve_type": "edwards25519"\n  },\n  "metadata": {\n    "address_type": "Enterprise"\n  }\n}\n'})})]})]}),"\n",(0,s.jsx)(n.h3,{id:"constructionpreprocess",children:(0,s.jsx)(n.code,{children:"/construction/preprocess"})}),"\n",(0,s.jsxs)(n.p,{children:["Cardano transactions require a ",(0,s.jsx)(n.code,{children:"ttl"})," (Time-to-live) to be defined. As it's explained in the Cardano docs, TTL represents a slot, or deadline by which a transaction must be submitted. The TTL is an absolute slot number, rather than a relative one, which means that the ",(0,s.jsx)(n.code,{children:"ttl"})," value should be greater than the current slot number. A transaction becomes invalid once its ttl expires."]}),"\n",(0,s.jsxs)(n.p,{children:["There are several restrictions that require a more complex workflow when defining ",(0,s.jsx)(n.code,{children:"ttl"})," for a transaction:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ttl"})," depends on the latest block slot number and Rosetta spec only allows online data to be fetched in ",(0,s.jsx)(n.code,{children:"/construction/metadata"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/construction/metadata"})," only accepts parameters produced, without any modifications, by ",(0,s.jsx)(n.code,{children:"/construction/preprocess"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["To be able to stay compliant with Rosetta spec but also let the user define a specific ",(0,s.jsx)(n.code,{children:"ttl"}),", a new optional parameter ",(0,s.jsx)(n.code,{children:"relative_ttl"})," within the metadata was introduced. If not set, a ",(0,s.jsx)(n.code,{children:"DEFAULT_RELATIVE_TTL"})," will be used."]}),"\n",(0,s.jsx)(n.p,{children:"Additionally, deposit parameters can be added to the metadata, which are used to take staking and pool operations into account while calculating the transaction size."}),"\n",(0,s.jsx)(n.h4,{id:"example-metadata",children:"Example metadata"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "network_identifier": {\n    "blockchain": "cardano",\n    "network": "mainnet"\n  },\n  "operations": [...],\n  "metadata": {\n    "relative_ttl": "100",\n    "deposit_parameters": {\n      "poolDeposit": "500000000",\n      "keyDeposit": "2000000"\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"constructionmetadata",children:(0,s.jsx)(n.code,{children:"/construction/metadata"})}),"\n",(0,s.jsxs)(n.p,{children:["Metadata endpoint needs to receive the ",(0,s.jsx)(n.code,{children:"relative_ttl"})," returned in process so it can calculate the actual ",(0,s.jsx)(n.code,{children:"ttl"})," based on latest block slot number."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "metadata": {\n    "ttl": "65294",\n    "suggested_fee": [\n      {\n        "currency": {\n          "decimals": 6,\n          "symbol": "ADA"\n        },\n        "value": "900000"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"constructionpayloads",children:(0,s.jsx)(n.code,{children:"/construction/payloads"})}),"\n",(0,s.jsxs)(n.p,{children:["Not only input and output operations are allowed but also special staking operations. Furthermore, transaction ",(0,s.jsx)(n.code,{children:"ttl"})," needs to be sent as string in the metadata."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "metadata": {\n    "ttl": "65294"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"constructionparse",children:(0,s.jsx)(n.code,{children:"/construction/parse"})}),"\n",(0,s.jsxs)(n.p,{children:["The request of this endpoint has no specific change but the response will have the operations parsed in the same way as the ones that are used to send as payload in the ",(0,s.jsx)(n.code,{children:"/construction/payloads"})," and ",(0,s.jsx)(n.code,{children:"/construction/preprocess"})," endpoints. This means that the order used in those two endpoints needs to be maintained exactly, otherwise the parse endpoint will not be able to reproduce the operations in the same order and the workflow will fail."]}),"\n",(0,s.jsx)(n.h3,{id:"constructioncombine",children:(0,s.jsx)(n.code,{children:"/construction/combine"})}),"\n",(0,s.jsxs)(n.p,{children:["In order to support Byron addresses an extra field called ",(0,s.jsx)(n.code,{children:"chain_code"})," in the ",(0,s.jsx)(n.code,{children:"account_identifier"}),"'s ",(0,s.jsx)(n.code,{children:"metadata"})," of the corresponding ",(0,s.jsx)(n.code,{children:"signing_payload"})," must be added when requesting to sign payloads. This value can be obtained by any of the Bip 32 Keys."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "signatures": [\n    {\n      "signing_payload": {\n        "account_identifier": {\n          "address": "addr1vxa5pudxg77g3sdaddecmw8tvc6hmynywn49lltt4fmvn7cpnkcpx",\n          "metadata": {\n            "chain_code": "dd75e154da417becec55cdd249327454138f082110297d5e87ab25e15fad150f"\n          }\n        },\n        "hex_bytes": "31fc9813a71d8db12a4f2e3382ab0671005665b70d0cd1a9fb6c4a4e9ceabc90",\n        "signature_type": "ed25519"\n      },\n      "public_key": {\n        "hex_bytes": "1B400D60AAF34EAF6DCBAB9BBA46001A23497886CF11066F7846933D30E5AD3F",\n        "curve_type": "edwards25519"\n      },\n      "signature_type": "ed25519",\n      "hex_bytes": "00000000000000000000000000"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"other-considerations",children:"Other considerations"}),"\n",(0,s.jsx)(n.h3,{id:"encoded-transactions",children:"Encoded transactions"}),"\n",(0,s.jsxs)(n.p,{children:["Both ",(0,s.jsx)(n.code,{children:"signed_unsigned"})," and ",(0,s.jsx)(n.code,{children:"unsigned_transaction"})," don't correspond to a valid Cardano Transaction that can be forwarded to the network as they contain extra data required in the Rosetta workflow. This means that such transactions cannot be decoded nor sent directly to a ",(0,s.jsx)(n.code,{children:"cardano-node"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"There is no expectation that the transactions which are constructed in Rosetta can be parsed by network-specific tools or broadcast on a non-Rosetta node. All parsing and broadcast of these transactions will occur exclusively over the Rosetta API."})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},9329:(e,n,a)=>{a.d(n,{A:()=>o});a(6540);var t=a(4164);const s={tabItem:"tabItem_Ymn6"};var r=a(4848);function o(e){let{children:n,hidden:a,className:o}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(s.tabItem,o),hidden:a,children:n})}}}]);