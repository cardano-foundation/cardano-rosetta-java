"use strict";(self.webpackChunkrosetta_docs=self.webpackChunkrosetta_docs||[]).push([[1294],{5537:(e,n,s)=>{s.d(n,{A:()=>S});var r=s(6540),t=s(4164),d=s(5627),i=s(6347),c=s(372),l=s(604),a=s(1861),o=s(8749);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function x(e){const{values:n,children:s}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:s,attributes:r,default:t}}=e;return{value:n,label:s,attributes:r,default:t}}))}(s);return function(e){const n=(0,a.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,s])}function u(e){let{value:n,tabValues:s}=e;return s.some((e=>e.value===n))}function j(e){let{queryString:n=!1,groupId:s}=e;const t=(0,i.W6)(),d=function(e){let{queryString:n=!1,groupId:s}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!s)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return s??null}({queryString:n,groupId:s});return[(0,l.aZ)(d),(0,r.useCallback)((e=>{if(!d)return;const n=new URLSearchParams(t.location.search);n.set(d,e),t.replace({...t.location,search:n.toString()})}),[d,t])]}function p(e){const{defaultValue:n,queryString:s=!1,groupId:t}=e,d=x(e),[i,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:s}=e;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:s}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${s.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=s.find((e=>e.default))??s[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:d}))),[a,h]=j({queryString:s,groupId:t}),[p,m]=function(e){let{groupId:n}=e;const s=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,d]=(0,o.Dv)(s);return[t,(0,r.useCallback)((e=>{s&&d.set(e)}),[s,d])]}({groupId:t}),b=(()=>{const e=a??p;return u({value:e,tabValues:d})?e:null})();(0,c.A)((()=>{b&&l(b)}),[b]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!u({value:e,tabValues:d}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),m(e)}),[h,m,d]),tabValues:d}}var m=s(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=s(4848);function g(e){let{className:n,block:s,selectedValue:r,selectValue:i,tabValues:c}=e;const l=[],{blockElementScrollPositionUntilNextRender:a}=(0,d.a_)(),o=e=>{const n=e.currentTarget,s=l.indexOf(n),t=c[s].value;t!==r&&(a(n),i(t))},h=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const s=l.indexOf(e.currentTarget)+1;n=l[s]??l[0];break}case"ArrowLeft":{const s=l.indexOf(e.currentTarget)-1;n=l[s]??l[l.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":s},n),children:c.map((e=>{let{value:n,label:s,attributes:d}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{l.push(e)},onKeyDown:h,onClick:o,...d,className:(0,t.A)("tabs__item",b.tabItem,d?.className,{"tabs__item--active":r===n}),children:s??n},n)}))})}function v(e){let{lazy:n,children:s,selectedValue:d}=e;const i=(Array.isArray(s)?s:[s]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===d));return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==d})))})}function y(e){const n=p(e);return(0,f.jsxs)("div",{className:(0,t.A)("tabs-container",b.tabList),children:[(0,f.jsx)(g,{...n,...e}),(0,f.jsx)(v,{...n,...e})]})}function S(e){const n=(0,m.A)();return(0,f.jsx)(y,{...e,children:h(e.children)},String(n))}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var r=s(6540);const t={},d=r.createContext(t);function i(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(d.Provider,{value:n},e.children)}},9207:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"install-and-deploy/boot-sequence","title":"Boot Sequence","description":"Startup order and dependencies for Cardano Rosetta Java","source":"@site/docs/install-and-deploy/boot-sequence.md","sourceDirName":"install-and-deploy","slug":"/install-and-deploy/boot-sequence","permalink":"/cardano-rosetta-java/docs/install-and-deploy/boot-sequence","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-foundation/cardano-rosetta-java/tree/main/docs/docs/install-and-deploy/boot-sequence.md","tags":[],"version":"current","lastUpdatedBy":"Lincon Vidal","lastUpdatedAt":1770206313000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Boot Sequence","description":"Startup order and dependencies for Cardano Rosetta Java"},"sidebar":"tutorialSidebar","previous":{"title":"Install and Deploy","permalink":"/cardano-rosetta-java/docs/category/install-and-deploy"},"next":{"title":"Getting Started with Docker Compose","permalink":"/cardano-rosetta-java/docs/install-and-deploy/docker"}}');var t=s(4848),d=s(8453),i=s(5537),c=s(9329);const l={sidebar_position:1,title:"Boot Sequence",description:"Startup order and dependencies for Cardano Rosetta Java"},a="Boot Sequence",o={},h=[{value:"Components",id:"components",level:2},{value:"Core",id:"core",level:3},{value:"Monitoring (optional)",id:"monitoring-optional",level:3},{value:"Startup Order",id:"startup-order",level:2},{value:"Monitoring Stack",id:"monitoring-stack",level:4},{value:"Sync Stages",id:"sync-stages",level:2},{value:"Shared Resources",id:"shared-resources",level:2},{value:"Health Checks",id:"health-checks",level:2}];function x(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"boot-sequence",children:"Boot Sequence"})}),"\n",(0,t.jsx)(n.admonition,{title:"Version 2.0",type:"info",children:(0,t.jsxs)(n.p,{children:["This documentation applies to ",(0,t.jsx)(n.strong,{children:"Rosetta Java v2.0 and later"}),"."]})}),"\n",(0,t.jsx)(n.p,{children:"The boot sequence solves three problems:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Blockchain sync is slow"}),": Syncing from genesis takes days. ",(0,t.jsx)(n.code,{children:"mithril"})," downloads verified snapshots, reducing this to hours."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Ingesting data into a moving target is wasteful"}),": ",(0,t.jsx)(n.code,{children:"yaci-indexer"})," parses blocks and ingests them into PostgreSQL. If it starts while the node is still syncing, it processes incomplete data. ",(0,t.jsx)(n.code,{children:"cardano-sync-waiter"})," blocks until the node catches up."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Indexes slow initial sync"}),": Maintaining PostgreSQL indexes while ingesting data is expensive. ",(0,t.jsx)(n.code,{children:"index-applier"})," creates them after ingestion completes."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"components",children:"Components"}),"\n",(0,t.jsx)(n.h3,{id:"core",children:"Core"}),"\n",(0,t.jsx)(n.p,{children:"These services are required to run Rosetta Java. One-shot services run once during startup; persistent services run continuously."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Service"}),(0,t.jsx)(n.th,{children:"Role"}),(0,t.jsx)(n.th,{children:"Port"}),(0,t.jsx)(n.th,{children:"Lifecycle"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"mithril"}),(0,t.jsx)(n.td,{children:"Downloads verified blockchain snapshots"}),(0,t.jsx)(n.td,{children:"-"}),(0,t.jsxs)(n.td,{children:["One-shot: skips if ",(0,t.jsx)(n.code,{children:"/node/db"})," exists"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cardano-node"}),(0,t.jsx)(n.td,{children:"Validates and relays blocks"}),(0,t.jsx)(n.td,{children:"3001"}),(0,t.jsx)(n.td,{children:"Persistent"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cardano-submit-api"}),(0,t.jsx)(n.td,{children:"Transaction submission endpoint"}),(0,t.jsx)(n.td,{children:"8090"}),(0,t.jsx)(n.td,{children:"Persistent"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cardano-sync-waiter"}),(0,t.jsx)(n.td,{children:"Blocks until node is synced"}),(0,t.jsx)(n.td,{children:"-"}),(0,t.jsx)(n.td,{children:"One-shot: exits when synced"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"db"}),(0,t.jsx)(n.td,{children:"PostgreSQL database for blockchain data"}),(0,t.jsx)(n.td,{children:"5432"}),(0,t.jsx)(n.td,{children:"Persistent"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"yaci-indexer"}),(0,t.jsx)(n.td,{children:"Parses blocks into database tables"}),(0,t.jsx)(n.td,{children:"9095"}),(0,t.jsx)(n.td,{children:"Persistent"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"api"}),(0,t.jsx)(n.td,{children:"Rosetta/Mesh API endpoints"}),(0,t.jsx)(n.td,{children:"8082"}),(0,t.jsx)(n.td,{children:"Persistent"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"index-applier"}),(0,t.jsx)(n.td,{children:"Adds query optimization after data ingestion"}),(0,t.jsx)(n.td,{children:"-"}),(0,t.jsxs)(n.td,{children:["One-shot ",(0,t.jsx)(n.strong,{children:"(New in v2.0)"})]})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"monitoring-optional",children:"Monitoring (optional)"}),"\n",(0,t.jsx)(n.p,{children:"These services provide observability into system health and performance. Deploy them alongside the core stack for production environments."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Service"}),(0,t.jsx)(n.th,{children:"Role"}),(0,t.jsx)(n.th,{children:"Port"}),(0,t.jsx)(n.th,{children:"Lifecycle"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"prometheus"}),(0,t.jsx)(n.td,{children:"Metrics collection"}),(0,t.jsx)(n.td,{children:"9090"}),(0,t.jsx)(n.td,{children:"Persistent"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"grafana"}),(0,t.jsx)(n.td,{children:"Metrics visualization"}),(0,t.jsx)(n.td,{children:"3000"}),(0,t.jsx)(n.td,{children:"Persistent"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"postgresql-exporter"}),(0,t.jsx)(n.td,{children:"Database metrics for Prometheus"}),(0,t.jsx)(n.td,{children:"9187"}),(0,t.jsx)(n.td,{children:"Persistent"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"node-exporter"}),(0,t.jsx)(n.td,{children:"System metrics for Prometheus"}),(0,t.jsx)(n.td,{children:"9100"}),(0,t.jsx)(n.td,{children:"Persistent"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"startup-order",children:"Startup Order"}),"\n",(0,t.jsx)(n.p,{children:"The core services must start in a specific order. Each service waits for its dependencies before proceeding."}),"\n",(0,t.jsx)(n.mermaid,{value:'flowchart TD\n    subgraph s1[Snapshot Download]\n        M(["mithril"])\n    end\n\n    subgraph s2[Node Synchronization]\n        N["cardano-node"]\n        SA["cardano-submit-api"]\n        SW{{"cardano-sync-waiter"}}\n    end\n\n    subgraph s3[Data Layer]\n        DB[("db")]\n        Y["yaci-indexer"]\n    end\n\n    subgraph s4[API Layer]\n        R["api"]\n        IA(["index-applier"])\n    end\n\n    subgraph s5[System Ready]\n        LIVE(("LIVE"))\n    end\n\n    M --\x3e|"snapshot ready"| N & SA\n    N --\x3e|"node running"| SW\n    SW --\x3e|"node synced"| DB\n    DB --\x3e|"db healthy"| Y\n    DB --\x3e|"db healthy"| R\n    Y --\x3e|"service started"| R\n    R --\x3e|"ingestion complete"| IA\n    IA --\x3e|"indexes applied"| LIVE'}),"\n",(0,t.jsx)(n.h4,{id:"monitoring-stack",children:"Monitoring Stack"}),"\n",(0,t.jsxs)(n.p,{children:["The monitoring services run independently from the core boot sequence. ",(0,t.jsx)(n.code,{children:"node-exporter"})," collects host metrics (CPU, RAM, disk) and has no container dependencies. ",(0,t.jsx)(n.code,{children:"postgresql-exporter"})," requires ",(0,t.jsx)(n.code,{children:"db"})," to be healthy before it can scrape database metrics."]}),"\n",(0,t.jsx)(n.mermaid,{value:'flowchart LR\n    subgraph Sources\n        SYS[/"system"/]\n        DB[("db")]\n    end\n\n    subgraph Exporters\n        NE["node-exporter"]\n        PE["postgresql-exporter"]\n    end\n\n    SYS --\x3e NE\n    DB --\x3e PE\n    NE --\x3e P["prometheus"]\n    PE --\x3e P\n    P --\x3e G["grafana"]'}),"\n",(0,t.jsx)(n.h2,{id:"sync-stages",children:"Sync Stages"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"/network/status"})," endpoint reports system state:"]}),"\n",(0,t.jsx)(n.mermaid,{value:"stateDiagram-v2\n    direction LR\n    [*] --\x3e SYNCING\n    SYNCING --\x3e APPLYING_INDEXES : indexes missing\n    APPLYING_INDEXES --\x3e LIVE : indexes applied\n    SYNCING --\x3e LIVE : indexes exist\n    LIVE --\x3e SYNCING : falls behind"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"SYNCING"}),": Data in PostgreSQL is behind the blockchain tip. This occurs during initial sync, or when the node or indexer falls behind. Queries may return incomplete data."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"APPLYING_INDEXES"}),": Data ingestion is complete. ",(0,t.jsx)(n.code,{children:"index-applier"})," is creating database indexes using ",(0,t.jsx)(n.code,{children:"CREATE INDEX CONCURRENTLY"}),". The API responds but queries may be slow until indexes are ready (~6 hours on mainnet)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"LIVE"}),": All data is ingested and all indexes are valid and ready. The system is fully operational for production queries."]}),"\n"]}),"\n",(0,t.jsxs)(i.A,{children:[(0,t.jsx)(c.A,{value:"mainnet",label:"Mainnet",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -s http://localhost:8082/network/status \\\n  -H "Content-Type: application/json" \\\n  -d \'{"network_identifier":{"blockchain":"cardano","network":"mainnet"}}\' \\\n  | jq -r \'.sync_status.stage\'\n'})})}),(0,t.jsx)(c.A,{value:"preprod",label:"Preprod",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -s http://localhost:8082/network/status \\\n  -H "Content-Type: application/json" \\\n  -d \'{"network_identifier":{"blockchain":"cardano","network":"preprod"}}\' \\\n  | jq -r \'.sync_status.stage\'\n'})})})]}),"\n",(0,t.jsx)(n.h2,{id:"shared-resources",children:"Shared Resources"}),"\n",(0,t.jsx)(n.p,{children:"These volumes must be persisted across container restarts to avoid re-syncing from scratch."}),"\n",(0,t.jsxs)(i.A,{children:[(0,t.jsx)(c.A,{value:"mainnet",label:"Mainnet",default:!0,children:(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Env Var"}),(0,t.jsx)(n.th,{children:"Host Path"}),(0,t.jsx)(n.th,{children:"Container Path"}),(0,t.jsx)(n.th,{children:"Purpose"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CARDANO_NODE_DIR"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/opt/rosetta-java-mainnet/node_data"})}),(0,t.jsx)(n.td,{children:"same as host"}),(0,t.jsx)(n.td,{children:"Node socket and blockchain data"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CARDANO_NODE_SOCKET_PATH"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"${CARDANO_NODE_DIR}/node.socket"})}),(0,t.jsx)(n.td,{children:"same as host"}),(0,t.jsx)(n.td,{children:"IPC socket for node communication"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CARDANO_NODE_DB"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"${CARDANO_NODE_DIR}/db"})}),(0,t.jsx)(n.td,{children:"same as host"}),(0,t.jsx)(n.td,{children:"Blockchain ledger"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CARDANO_CONFIG"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"./config/node/mainnet"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/config"})}),(0,t.jsx)(n.td,{children:"Genesis files, topology"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"DB_PATH"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/opt/rosetta-java-mainnet/sql_data"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/var/lib/postgresql/data"})}),(0,t.jsx)(n.td,{children:"PostgreSQL data files"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"-"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"./api/src/main/resources/config/db-indexes.yaml"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/config/db-indexes.yaml"})}),(0,t.jsxs)(n.td,{children:["Index definitions for ",(0,t.jsx)(n.code,{children:"index-applier"})]})]})]})]})}),(0,t.jsx)(c.A,{value:"preprod",label:"Preprod",children:(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Env Var"}),(0,t.jsx)(n.th,{children:"Host Path"}),(0,t.jsx)(n.th,{children:"Container Path"}),(0,t.jsx)(n.th,{children:"Purpose"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CARDANO_NODE_DIR"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/opt/rosetta-java-preprod/node_data"})}),(0,t.jsx)(n.td,{children:"same as host"}),(0,t.jsx)(n.td,{children:"Node socket and blockchain data"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CARDANO_NODE_SOCKET_PATH"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"${CARDANO_NODE_DIR}/node.socket"})}),(0,t.jsx)(n.td,{children:"same as host"}),(0,t.jsx)(n.td,{children:"IPC socket for node communication"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CARDANO_NODE_DB"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"${CARDANO_NODE_DIR}/db"})}),(0,t.jsx)(n.td,{children:"same as host"}),(0,t.jsx)(n.td,{children:"Blockchain ledger"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CARDANO_CONFIG"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"./config/node/preprod"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/config"})}),(0,t.jsx)(n.td,{children:"Genesis files, topology"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"DB_PATH"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/opt/rosetta-java-preprod/sql_data"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/var/lib/postgresql/data"})}),(0,t.jsx)(n.td,{children:"PostgreSQL data files"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"-"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"./api/src/main/resources/config/db-indexes.yaml"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/config/db-indexes.yaml"})}),(0,t.jsxs)(n.td,{children:["Index definitions for ",(0,t.jsx)(n.code,{children:"index-applier"})]})]})]})]})})]}),"\n",(0,t.jsx)(n.h2,{id:"health-checks",children:"Health Checks"}),"\n",(0,t.jsx)(n.p,{children:"Use these methods to verify each service is running and responsive."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Service"}),(0,t.jsx)(n.th,{children:"Method"}),(0,t.jsx)(n.th,{children:"Command"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"db"}),(0,t.jsx)(n.td,{children:"PostgreSQL ready"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"pg_isready -U $DB_USER -d $DB_NAME"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"api"}),(0,t.jsx)(n.td,{children:"HTTP POST"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"curl -X POST .../network/options"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"api"}),(0,t.jsx)(n.td,{children:"Sync status"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"curl -X POST .../network/status"})," \u2192 check ",(0,t.jsx)(n.code,{children:"stage"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"yaci-indexer"}),(0,t.jsx)(n.td,{children:"Spring actuator"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"curl .../actuator/health"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cardano-node"}),(0,t.jsx)(n.td,{children:"CLI query"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"cardano-cli query tip --mainnet"})," or ",(0,t.jsx)(n.code,{children:"--testnet-magic <N>"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cardano-submit-api"}),(0,t.jsx)(n.td,{children:"TCP port"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"nc -zv localhost 8090"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"prometheus"}),(0,t.jsx)(n.td,{children:"HTTP GET"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"curl .../-/healthy"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"grafana"}),(0,t.jsx)(n.td,{children:"HTTP GET"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"curl .../api/health"})})]})]})]})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(x,{...e})}):x(e)}},9329:(e,n,s)=>{s.d(n,{A:()=>i});s(6540);var r=s(4164);const t={tabItem:"tabItem_Ymn6"};var d=s(4848);function i(e){let{children:n,hidden:s,className:i}=e;return(0,d.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,i),hidden:s,children:n})}}}]);