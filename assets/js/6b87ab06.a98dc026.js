"use strict";(self.webpackChunkrosetta_docs=self.webpackChunkrosetta_docs||[]).push([[515],{2178:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"legacy-docs/catalyst-vote-support","title":"Catalyst Vote Support","description":"Documentation for Catalyst voting functionality in the legacy Cardano Rosetta implementation","source":"@site/docs/legacy-docs/catalyst-vote-support.md","sourceDirName":"legacy-docs","slug":"/legacy-docs/catalyst-vote-support","permalink":"/cardano-rosetta-java/docs/legacy-docs/catalyst-vote-support","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-foundation/cardano-rosetta-java/tree/main/docs/docs/legacy-docs/catalyst-vote-support.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Catalyst Vote Support","description":"Documentation for Catalyst voting functionality in the legacy Cardano Rosetta implementation"},"sidebar":"tutorialSidebar","previous":{"title":"Staking Support","permalink":"/cardano-rosetta-java/docs/legacy-docs/staking-support"}}');var o=t(4848),i=t(8453);const s={sidebar_position:7,title:"Catalyst Vote Support",description:"Documentation for Catalyst voting functionality in the legacy Cardano Rosetta implementation"},r="Catalyst Vote registration",c={},d=[{value:"Construction api",id:"construction-api",level:2},{value:"Vote Registration operation",id:"vote-registration-operation",level:2},{value:"Voting Signature",id:"voting-signature",level:2},{value:"Data api",id:"data-api",level:2},{value:"Request example",id:"request-example",level:3},{value:"Response example with a vote operatoin operation",id:"response-example-with-a-vote-operatoin-operation",level:3}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"catalyst-vote-registration",children:"Catalyst Vote registration"})}),"\n",(0,o.jsx)(n.h2,{id:"construction-api",children:"Construction api"}),"\n",(0,o.jsxs)(n.p,{children:["In the request for ",(0,o.jsx)(n.code,{children:"/construction/preprocess"})," and ",(0,o.jsx)(n.code,{children:"/construction/payloads"})," endpoints, in addition to the current operations, a new operation 'voteRegistration' has been added"]}),"\n",(0,o.jsx)(n.h2,{id:"vote-registration-operation",children:"Vote Registration operation"}),"\n",(0,o.jsxs)(n.p,{children:["Vote registration operations need, in addition, a metadata containing ",(0,o.jsx)(n.strong,{children:"voteRegistrationMetadata"})," which are the parameters needed to register a Catalyst Vote and are obtained mostly outside Rosetta."]}),"\n",(0,o.jsx)(n.p,{children:"The operation may look like this:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "network_identifier": {\n    "blockchain": "cardano",\n    "network": "mainnet"\n  },\n  "operations": [\n    // other operations before\n    {\n      "operation_identifier": {\n        "index": 1\n      },\n      "status": "success",\n      "type": "voteRegistration",\n      "metadata": {\n        "voteRegistrationMetadata": {\n          "rewardAddress": "addr1q9nr7yuhzsmmdchsjacuqef5cnlajk2s4j2rjre5uzgmtw5vcjwuayent36vkw403c8hat9csyawfgg88qlwweyeshnqsh9r5q",\n          "stakeKey": {\n            "curve_type": "edwards25519",\n            "hex_bytes": "56f29f391a3bb5ff90637b2d2d0a32590214871284b0577e4671b0c1a83f79ba"\n          },\n          "votingKey": {\n            "curve_type": "edwards25519",\n            "hex_bytes": "8bcec4282239b2cc1a7d8bb294c154c849fc200c7ebd27ef45e610d849bc302a"\n          },\n          "votingNonce": 26912766,\n          "votingSignature": "f75f7a54a79352f9d0e2c4de4e8ded8ae9304fa0f3b021754f8d149c90c7b01e1c6bbfdd623c294d82f5e5cbbfc0bd6fd1c674780db4025446e2eafc87f61b0a"\n        }\n      }\n    }\n    // other operations after\n  ],\n  "metadata": {\n    "ttl": "1000"\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"rewardAddress"})," Staking address which will receive voting rewards"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"stakeKey"})," Public key of the corresponding staking account passed as hex string"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"votingKey"})," Catalyst voting public key"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"votingNonce"})," Current slot number"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"votingSignature"})," Previously vote data signed with the staking private key passed as hex string"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"All of these values will be included in the transaction metadata with the following structure:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "61284": {\n    // voting_key - CBOR byte array\n    "1": "0xa6a3c0447aeb9cc54cf6422ba32b294e5e1c3ef6d782f2acff4a70694c4d1663",\n    // stake_pub - CBOR byte array\n    "2": "0xad4b948699193634a39dd56f779a2951a24779ad52aa7916f6912b8ec4702cee",\n    // reward_address - CBOR byte array\n    "3": "0x00588e8e1d18cba576a4d35758069fe94e53f638b6faf7c07b8abd2bc5c5cdee47b60edc7772855324c85033c638364214cbfc6627889f81c4",\n    // nonce\n    "4": 5479467\n  },\n  "61285": {\n    // signature - ED25119 signature CBOR byte array\n    "1": "0x8b508822ac89bacb1f9c3a3ef0dc62fd72a0bd3849e2381b17272b68a8f52ea8240dcc855f2264db29a8512bfcd522ab69b982cb011e5f43d0154e72f505f007"\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"voting-signature",children:"Voting Signature"}),"\n",(0,o.jsx)(n.p,{children:'This value is obtained by signing the voting data("61284" field) blake2b-256 hashed with the staking private key.'}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.em,{children:["For more information about where these values come from you can check this useful ",(0,o.jsx)(n.a,{href:"https://cips.cardano.org/cips/cip15/",children:"link"})]})}),"\n",(0,o.jsx)(n.h2,{id:"data-api",children:"Data api"}),"\n",(0,o.jsxs)(n.p,{children:["Vote registration operations are also returned in ",(0,o.jsx)(n.code,{children:"/block"})," and ",(0,o.jsx)(n.code,{children:"/block/transaction"})," endpoints if corresponds to.\nSince a vote is included in the transaction metadata, every metadata that follows the mentioned structure will be traited as a vote operation."]}),"\n",(0,o.jsx)(n.h3,{id:"request-example",children:"Request example"}),"\n",(0,o.jsxs)(n.p,{children:["In this example we are using ",(0,o.jsx)(n.code,{children:"/block/transaction"})," endpoint with the specified transaction and block."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "network_identifier": { "blockchain": "cardano", "network": "mainnet" },\n  "block_identifier": {\n    "index": 5593749,\n    "hash": "1c42fd317888b2aafe9f84787fdd3b90b95be06687a217cf4e6ca95130157eb5"\n  },\n  "transaction_identifier": {\n    "hash": "adeb7b6845f3f4b0e74275588412cf00912b615e4bbf76d111326ce899260c59"\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"response-example-with-a-vote-operatoin-operation",children:"Response example with a vote operatoin operation"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "transaction_identifier": {\n    "hash": "adeb7b6845f3f4b0e74275588412cf00912b615e4bbf76d111326ce899260c59"\n  },\n  "operations": [\n    // other operations\n    {\n      "operation_identifier": {\n        "index": 1\n      },\n      "status": "success",\n      "type": "voteRegistration",\n      "metadata": {\n        "voteRegistrationMetadata": {\n          "rewardAddress": "addr1q9nr7yuhzsmmdchsjacuqef5cnlajk2s4j2rjre5uzgmtw5vcjwuayent36vkw403c8hat9csyawfgg88qlwweyeshnqsh9r5q",\n          "stakeKey": {\n            "curve_type": "edwards25519",\n            "hex_bytes": "56f29f391a3bb5ff90637b2d2d0a32590214871284b0577e4671b0c1a83f79ba"\n          },\n          "votingKey": {\n            "curve_type": "edwards25519",\n            "hex_bytes": "8bcec4282239b2cc1a7d8bb294c154c849fc200c7ebd27ef45e610d849bc302a"\n          },\n          "votingNonce": 26912766,\n          "votingSignature": "f75f7a54a79352f9d0e2c4de4e8ded8ae9304fa0f3b021754f8d149c90c7b01e1c6bbfdd623c294d82f5e5cbbfc0bd6fd1c674780db4025446e2eafc87f61b0a"\n        }\n      }\n    }\n    // other operations here\n  ]\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var a=t(6540);const o={},i=a.createContext(o);function s(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);