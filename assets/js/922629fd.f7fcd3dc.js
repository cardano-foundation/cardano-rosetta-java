"use strict";(self.webpackChunkrosetta_docs=self.webpackChunkrosetta_docs||[]).push([[723],{479:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"legacy-docs/pool-operations-support","title":"Pool Operations Support","description":"Documentation for stake pool operations in the legacy Cardano Rosetta implementation","source":"@site/docs/legacy-docs/pool-operations-support.md","sourceDirName":"legacy-docs","slug":"/legacy-docs/pool-operations-support","permalink":"/cardano-rosetta-java/docs/legacy-docs/pool-operations-support","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-foundation/cardano-rosetta-java/tree/main/docs/docs/legacy-docs/pool-operations-support.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Pool Operations Support","description":"Documentation for stake pool operations in the legacy Cardano Rosetta implementation"},"sidebar":"tutorialSidebar","previous":{"title":"Multi-Assets Support","permalink":"/cardano-rosetta-java/docs/legacy-docs/multi-assets-support"},"next":{"title":"Rosetta Custom Definitions","permalink":"/cardano-rosetta-java/docs/legacy-docs/rosetta-custom-definitions"}}');var t=o(4848),r=o(8453);const i={sidebar_position:4,title:"Pool Operations Support",description:"Documentation for stake pool operations in the legacy Cardano Rosetta implementation"},s="Stake pools support",c={},d=[{value:"Stake pool operations in construction api",id:"stake-pool-operations-in-construction-api",level:2},{value:"Pool registration operation",id:"pool-registration-operation",level:3},{value:"Relay IP&#39;s format",id:"relay-ips-format",level:3},{value:"Pool registration with certificate operation",id:"pool-registration-with-certificate-operation",level:3},{value:"Pool retirement operation",id:"pool-retirement-operation",level:3},{value:"Stake pool operations in data api",id:"stake-pool-operations-in-data-api",level:2},{value:"Request example",id:"request-example",level:3},{value:"Response example with a pool retirement operation",id:"response-example-with-a-pool-retirement-operation",level:3},{value:"Response example with a pool registration operation",id:"response-example-with-a-pool-registration-operation",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"stake-pools-support",children:"Stake pools support"})}),"\n",(0,t.jsx)(n.h2,{id:"stake-pool-operations-in-construction-api",children:"Stake pool operations in construction api"}),"\n",(0,t.jsxs)(n.p,{children:["In the request for ",(0,t.jsx)(n.code,{children:"/construction/preprocess"})," and ",(0,t.jsx)(n.code,{children:"/construction/payloads"})," endpoints, in addition to the current operations, three new operations have been added in order to support stake pools."]}),"\n",(0,t.jsx)(n.p,{children:"For each of these operations, the cold key is needed to sign the payloads, so it will be passed as an address."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"'poolRegistration',"}),"\n",(0,t.jsx)(n.li,{children:"'poolRegistrationWithCert',"}),"\n",(0,t.jsx)(n.li,{children:"'poolRetirement'"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"pool-registration-operation",children:"Pool registration operation"}),"\n",(0,t.jsxs)(n.p,{children:["Pool registration operations need, in addition, and ",(0,t.jsx)(n.strong,{children:"poolRegistrationParams"})," which are the parameters needed to register a new stake pool."]}),"\n",(0,t.jsx)(n.p,{children:"The pool registration deposit amount is taken from protocol."}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"rewardAddress"})," param represents the creator's reward address. Also, the ",(0,t.jsx)(n.code,{children:"poolOwners"})," params are the reward addresses of each pool owner."]}),"\n",(0,t.jsxs)(n.p,{children:["The signature of ",(0,t.jsx)(n.code,{children:"rewardAddress"})," and each pool owner signature given at ",(0,t.jsx)(n.code,{children:"poolOwners"})," plus the signature done with cold keys will be required at ",(0,t.jsx)(n.code,{children:"/construction/combine"})," endpoint in order to sign the transaction. Also, these signatures will be specifically requested at ",(0,t.jsx)(n.code,{children:"/construction/payloads"})," response."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "network_identifier": {\n    "blockchain": "cardano",\n    "network": "mainnet"\n  },\n  "operations": [\n    // other operations before\n    {\n      "operation_identifier": {\n        "index": 3\n      },\n      "type": "poolRegistration",\n      "status": "success",\n      "account": {\n        "address": "1b268f4cba3faa7e36d8a0cc4adca2096fb856119412ee7330f692b5"\n      },\n      "metadata": {\n        "poolRegistrationParams": {\n          "vrfKeyHash": "8dd154228946bd12967c12bedb1cb6038b78f8b84a1760b1a788fa72a4af3db0",\n          "rewardAddress": "stake1uxa5pudxg77g3sdaddecmw8tvc6hmynywn49lltt4fmvn7caek7a5",\n          "pledge": "5000000",\n          "cost": "3000000",\n          "poolOwners": [\n            "stake1uxly0q2cnpxrjrqm9vpnr9dwkr0j945gulhhgs3dx33l47sweg9er"\n          ],\n          "relays": [\n            {\n              "type": "single_host_addr",\n              "ipv4": "127.0.0.1",\n              "ipv6": "2345:0425:2ca1:0000:0000:0567:5673:23b5",\n              "port": "32"\n            }\n          ],\n          "margin": {\n            "numerator": "1",\n            "denominator": "1"\n          },\n          "poolMetadata": {\n            "url": "poolMetadataUrl",\n            "hash": "9ac2217288d1ae0b4e15c41b58d3e05a13206fd9ab81cb15943e4174bf30c90b"\n          }\n        }\n      }\n    }\n    // other operations after\n  ],\n  "metadata": {\n    "ttl": "1000"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"relay-ips-format",children:"Relay IP's format"}),"\n",(0,t.jsx)(n.p,{children:"When registrate a stake pool, the relay IP's must be specified. Depending on the version chosen, the following format are expected."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"IPv4"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Each strip of ### represent a number between 0 and 255"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"###.###.###.###\nFor example:\n127.0.0.1\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"IPv6"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Each strip of #### represents a hexadecimal number between 0000 and FFFF"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"####:####:####:####:####:####:####:####\nFor example:\n2345:0425:2ca1:0000:0000:0567:5673:23b5\n"})}),"\n",(0,t.jsx)(n.h3,{id:"pool-registration-with-certificate-operation",children:"Pool registration with certificate operation"}),"\n",(0,t.jsxs)(n.p,{children:["Pool registration with certificate operation, needs in addition to the rest of the parameters, the certificate passed as hex string in ",(0,t.jsx)(n.strong,{children:"metadata.poolRegistrationCert"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "operation_identifier": {\n    "index": 3\n  },\n  "type": "poolRegistrationWithCert",\n  "status": "success",\n  "account": {\n    "address": "1b268f4cba3faa7e36d8a0cc4adca2096fb856119412ee7330f692b5"\n  },\n  "metadata": {\n    "poolRegistrationCert": "8a03581c1b268f4cba3faa7e36d8a0cc4adca2096fb856119412ee7330f692b558208dd154228946bd12967c12bedb1cb6038b78f8b84a1760b1a788fa72a4af3db01a004c4b401a002dc6c0d81e820101581de1bb40f1a647bc88c1bd6b738db8eb66357d926474ea5ffd6baa76c9fb81581c7a9a4d5a6ac7a9d8702818fa3ea533e56c4f1de16da611a730ee3f008184001820445820f5d9505820f5d9ea167fd2e0b19647f18dd1e0826f706f6f6c4d6574616461746155726c58209ac2217288d1ae0b4e15c41b58d3e05a13206fd9ab81cb15943e4174bf30c90b"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"pool-retirement-operation",children:"Pool retirement operation"}),"\n",(0,t.jsx)(n.p,{children:"A pool retirement operation contains the epoch in which we want to retire the pool."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "operation_identifier": {\n    "index": 1\n  },\n  "type": "poolRetirement",\n  "status": "success",\n  "account": {\n    "address": "153806dbcd134ddee69a8c5204e38ac80448f62342f8c23cfe4b7edf"\n  },\n  "metadata": {\n    "epoch": 200\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"stake-pool-operations-in-data-api",children:"Stake pool operations in data api"}),"\n",(0,t.jsxs)(n.p,{children:["Support in endpoints ",(0,t.jsx)(n.code,{children:"block/transaction"})," and ",(0,t.jsx)(n.code,{children:"block"})," to return transactions with pool registration and pool retirement operations were added."]}),"\n",(0,t.jsx)(n.h3,{id:"request-example",children:"Request example"}),"\n",(0,t.jsx)(n.p,{children:"This is the request necessary to query a specific block."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "network_identifier": { "blockchain": "cardano", "network": "mainnet" },\n  "block_identifier": {\n    "index": 236746,\n    "hash": "b389d1c4975563bf4199afeaa1434dfd1b406e30ac4eda884a03ecef8cd0a87a"\n  },\n  "transaction_identifier": {\n    "hash": "dcbff41c50c5b4012d49be5be75b11a0c5289515258ef4cf108eb6ec4ed5f37a"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"response-example-with-a-pool-retirement-operation",children:"Response example with a pool retirement operation"}),"\n",(0,t.jsx)(n.p,{children:"As a response, all the operations contained in the transaction block were retrieved."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "transaction_identifier": {\n    "hash": "dcbff41c50c5b4012d49be5be75b11a0c5289515258ef4cf108eb6ec4ed5f37a"\n  },\n  "operations": [\n    // other operations\n    {\n      "operation_identifier": { "index": 0 },\n      "type": "poolRetirement",\n      "status": "success",\n      "account": {\n        "address": "d6aafa5358b98373449434542e3da3564bc71635ae3247dc1a2b7b0e"\n      },\n      "metadata": {\n        "epoch": 676,\n        "refundAmount": {\n          "value": "-500000000",\n          "currency": { "symbol": "ADA", "decimals": 6 }\n        }\n      }\n    }\n    // other operations here\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"response-example-with-a-pool-registration-operation",children:"Response example with a pool registration operation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "transaction_identifier": {\n    "hash": "dcbff41c50c5b4012d49be5be75b11a0c5289515258ef4cf108eb6ec4ed5f37a"\n  },\n  "operations": [\n    //{"other operations},\n    {\n      "operation_identifier": { "index": 2 },\n      "type": "poolRegistration",\n      "status": "success",\n      "account": {\n        "address": "503c82138b10d84b0ba36ff2e7342ea7fc40c57498dbc6fafe0cd322"\n      },\n      "metadata": {\n        "depositAmount": {\n          "currency": {\n            "decimals": 6,\n            "symbol": "ADA"\n          },\n          "value": "500000000"\n        },\n        "poolRegistrationParams": {\n          "rewardAddress": "e08a1766394908dedeb89d2d47673cc1851140acceaa0746a5e870eae2",\n          "cost": "340000000",\n          "margin_percentage": "0.08",\n          "pledge": "799450000000",\n          "poolOwners": [\n            "8a1766394908dedeb89d2d47673cc1851140acceaa0746a5e870eae2"\n          ],\n          "relays": [\n            {\n              "dnsName": "relays.cardano-launchpad.chaincrucial.io",\n              "ipv4": "",\n              "ipv6": "",\n              "port": "23001"\n            }\n          ],\n          "vrfKeyHash": "74511e297e8d8670729af5a4eb08ff8b49f0247f1100f28ce5599b44f07b57b4"\n        }\n      }\n    }\n    // ,{other operations here}\n  ]\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>s});var a=o(6540);const t={},r=a.createContext(t);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);